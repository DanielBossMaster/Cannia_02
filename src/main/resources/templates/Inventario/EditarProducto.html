<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="es">

<head>
    <meta charset="UTF-8">
    <title>Editar Producto</title>

    <link th:href="@{/css/VeterinarioCss/Inventario.css}" rel="stylesheet">

</head>

<body>
<header class="barra-superior" id="encabezado-principal">
</header>

<div class="modal" id="modalEditar">
<div class="card editar-card">

    <h2>Editar Producto</h2>

    <form th:action="@{/inventario/productos/actualizar}"
          th:object="${producto}" method="post" enctype="multipart/form-data">

        <input type="hidden" th:field="*{id}">

        <div class="form-group">
            <label>Foto actual</label><br>
            <img th:if="${producto.fotoBase64 != null}"
                 th:src="'data:image/jpeg;base64,' + ${producto.fotoBase64}"
                 style="width:120px;height:120px;border-radius:8px;">
        </div>

        <div class="form-group">
            <label>Cambiar foto</label>
            <input type="file" name="archivoImagen" class="form-control" accept="image/*">
        </div>

        <div class="form-group">
            <label>Nombre</label>
            <input type="text" th:field="*{nombre}" class="form-control" required>
        </div>

        <div class="form-group">
            <label>Descripción</label>
            <input type="text" th:field="*{descripcion}" class="form-control" required>
        </div>

        <div class="form-group">
            <label>Cantidad</label>
            <input type="number" th:field="*{cantidad}" min="0" class="form-control" required>
        </div>

        <div class="form-group">
            <label>Valor</label>
            <input type="number" th:field="*{valor}" min="0" step="0.01" class="form-control" required>
        </div>

        <div class="form-group">
            <label>Unidad de Medida</label>
            <select th:field="*{unidadMedida}" class="form-control">
                <option value="Kg">Kg</option>
                <option value="g">g</option>
                <option value="l">l</option>
                <option value="mL">mL</option>
            </select>
        </div>

        <!-- ESTADO CON PUNTO EDITABLE -->
        <div class="form-group toggle-container">
            <label>Estado</label>

            <!-- Punto visible -->
            <span id="estadoDot"
                  th:classappend="${producto.estado} ? 'estado-dot on' : 'estado-dot off'">
            </span>

            <!-- Checkbox que sí se envía -->
            <input type="checkbox" id="estadoCheck" th:field="*{estado}">
        </div>

        <button type="submit" class="btn btn-primary">Guardar Cambios</button>
        <a th:href="@{/inventario/productos}" class="btn btn-secondary">Cancelar</a>

    </form>

</div>
</div>


<script>
    const check = document.getElementById("estadoCheck");
    const dot = document.getElementById("estadoDot");

    check.addEventListener("change", () => {
        if (check.checked) {
            dot.classList.remove("off");
            dot.classList.add("on");
        } else {
            dot.classList.remove("on");
            dot.classList.add("off");
        }
    });
    document.body.classList.add("modal-open"); // al abrir modal
    document.body.classList.remove("modal-open"); // al cerrar modal

</script>

</body>
</html>
